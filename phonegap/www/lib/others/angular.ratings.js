//https://raw.githubusercontent.com/thomporter/angular-ratings/master/angular.ratings.js
// Generated by CoffeeScript 1.7.1
(function () {
    var app;

    app = angular.module('ratings', []);

    app.directive("angularRatings", function () {
        return {
            restrict: 'E',
            scope: {
                model: '=ngModel',
                notifyId: '=notifyId'
            },
            replace: true,
            transclude: true,
            template: '<div><ol class="angular-ratings">' + '<li ng-class="{active:model>0,over:over>0}"><i class="fa"/></li>' + '<li ng-class="{active:model>1,over:over>1}"><i class="fa"/></li>' + '<li ng-class="{active:model>2,over:over>2}"><i class="fa"/></li>' + '<li ng-class="{active:model>3,over:over>3}"><i class="fa"/></li>' + '<li ng-class="{active:model>4,over:over>4}"><i class="fa"/></li>' + '</ol></div>',
            controller: [
              '$scope', '$attrs', '$http', function ($scope, $attrs, $http) {
                  $scope.over = 0;
                  $scope.setRating = function (rating) {
                      $scope.model = rating;
                      $scope.$apply();
                      if ($attrs.notifyUrl !== void 0 && $scope.notifyId) {
                          return $http.post($attrs.notifyUrl, {
                              id: $scope.notifyId,
                              rating: rating
                          }).error(function (data) {
                              if (typeof data === 'string') {
                                  alert(data);
                              }
                              return $scope.model = 0;
                          });
                      }
                  };
                  return $scope.setOver = function (n) {
                      $scope.over = n;
                      return $scope.$apply();
                  };
              }
            ],
            link: function (scope, iElem, iAttrs) {
                if (iAttrs.notifyUrl !== void 0) {
                    return angular.forEach(iElem.children(), function (ol) {
                        return angular.forEach(ol.children, function (li) {
                            li.addEventListener('mouseover', function () {
                                return scope.setOver(parseInt(li.innerHTML));
                            });
                            li.addEventListener('mouseout', function () {
                                return scope.setOver(0);
                            });
                            return li.addEventListener('click', function () {
                                return scope.setRating(parseInt(li.innerHTML));
                            });
                        });
                    });
                }
            }
        };
    });

}).call(this);